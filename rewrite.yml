---
type: specs.openrewrite.org/v1beta/recipe
name: org.goafabric.spring4
recipeList:
  - org.openrewrite.gradle.plugins.UpgradePluginVersion:
      pluginIdPattern: org.springframework.boot
      newVersion: 4.0.0-M1

  - org.openrewrite.gradle.AddDependency:
      groupId: org.springframework.boot
      artifactId: spring-boot-starter-opentelemetry
      version: 4.0.0-M1
      configuration: implementation

  - org.openrewrite.gradle.AddDependency:
      groupId: org.springframework.boot
      artifactId: spring-boot-starter-flyway
      configuration: implementation
      #onlyIfUsing: org.flywaydb.*

  - org.openrewrite.gradle.AddDependency:
      groupId: org.springframework.boot
      artifactId: spring-boot-starter-restclient
      configuration: implementation
      #onlyIfUsing: org.springframework.web.client.support.RestClientAdapter


  #  - org.openrewrite.java.dependencies.UpgradeDependencyVersion:
#      groupId: com.fasterxml.jackson*
#      artifactId: jackson-module*
#      newVersion: 29.X
#

  # remove incompatible dependencies
  - org.openrewrite.gradle.RemoveDependency:
      groupId: net.ttddyy.observation
      artifactId: datasource-micrometer-spring-boot

  - org.openrewrite.gradle.RemoveDependency:
      groupId: org.springdoc
      artifactId: springdoc-openapi-starter-webmvc-ui

  - org.openrewrite.gradle.plugins.RemoveBuildPlugin:
      pluginId: org.springdoc.openapi-gradle-plugin

#  - org.openrewrite.yaml.ChangePropertyValue:
#      propertyKey: springdoc.enable-kotlin
#      newValue: false

  # update packages
  - org.openrewrite.java.ChangePackage:
      oldPackageName: org.springframework.boot.autoconfigure.flyway
      newPackageName: org.springframework.boot.flyway.autoconfigure

  - org.openrewrite.java.ChangePackage:
      oldPackageName: org.springframework.boot.autoconfigure.orm.jpa
      newPackageName: org.springframework.boot.hibernate.autoconfigure

  - org.openrewrite.java.ChangePackage:
      oldPackageName: org.springframework.boot.test.web.server
      newPackageName: org.springframework.boot.web.server.test

